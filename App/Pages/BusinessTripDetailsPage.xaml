<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:App.PageModels"
             xmlns:models="clr-namespace:BusinessLayer;assembly=BusinessLayer"
             x:Class="App.Pages.BusinessTripDetailsPage"
             x:DataType="pageModels:BusinessTripDetailsPageModel">

    <Grid RowDefinitions="Auto,*">
        <!-- Header with frame content -->
        <Frame Grid.Row="0" 
           BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Primary}}"
           Padding="20"
           Margin="0"
           CornerRadius="0">
            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                <!-- Cancel Button (Left) -->
                <Button Grid.Row="0" Grid.Column="0"
                    Text="â† ĞĞ°Ğ·Ğ°Ğ´" 
                    Command="{Binding CancelCommand}"
                    BackgroundColor="Transparent"
                    TextColor="White"
                    FontSize="16"
                    HorizontalOptions="Start"
                    VerticalOptions="Center"/>

                <!-- Project Name (Middle) -->
                <Label Grid.Row="0" Grid.Column="1"
<<<<<<< Updated upstream
                   Text="{Binding BusinessTrip.ProjectName}" 
                   FontSize="20" 
                   FontAttributes="Bold"
                   TextColor="White"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"/>

                <!-- Status (Right) -->
                <Label Grid.Row="0" Grid.Column="2"
                   Text="{Binding BusinessTrip.StatusText}"
                   FontSize="14"
                   TextColor="White"
                   FontAttributes="Bold"
                   HorizontalOptions="End"
                   VerticalOptions="Center"/>

                <!-- Task (Full width below) -->
                <Label Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3"
                   Text="{Binding BusinessTrip.Task}" 
                   FontSize="16"
                   TextColor="White"
                   HorizontalOptions="Center"/>
=======
                       Text="{Binding BusinessTrip.Status}"
                       FontSize="14"
                       TextColor="White"
                       FontAttributes="Bold"
                       HorizontalOptions="End"/>
                
                <Label Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                       Text="{Binding BusinessTrip.Task}" 
                       FontSize="16"
                       TextColor="White"
                       Margin="0,5,0,0"/>
>>>>>>> Stashed changes
            </Grid>
        </Frame>

        <!-- Content -->
        <ScrollView Grid.Row="1" VerticalScrollBarVisibility="Never">
            <VerticalStackLayout Padding="20" Spacing="15">

                <!-- Quick Info Cards - Now with full width utilization -->
                <Grid ColumnDefinitions="*,10,*" ColumnSpacing="0" Margin="0,0,0,10">
                    <!-- Start Date Card -->
                    <Frame Grid.Column="0"
                        BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#2D2D2D}"
                        CornerRadius="10" 
                        Padding="15"
                        HasShadow="True"
                        HorizontalOptions="FillAndExpand">
                        <VerticalStackLayout HorizontalOptions="Center" Spacing="5">
                            <Label Text="ğŸ“…" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="{Binding BusinessTrip.StartDate, StringFormat='{0:dd/MM/yyyy}'}" 
                   FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                            <Label Text="ĞĞ°Ñ‡Ğ°Ğ»Ğ½Ğ° Ğ´Ğ°Ñ‚Ğ°" FontSize="12" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Destination Card -->
                    <Frame Grid.Column="2"
                        BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#2D2D2D}"
                        CornerRadius="10" 
                        Padding="15"
                        HasShadow="True"
                        HorizontalOptions="FillAndExpand">
                        <VerticalStackLayout HorizontalOptions="Center" Spacing="5">
                            <Label Text="ğŸ“" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="{Binding BusinessTrip.Destination}" 
                                FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                            <Label Text="Ğ”ĞµÑÑ‚Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ" FontSize="12" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Frame>
                </Grid>

                <!-- Duration and Cost - Second Row -->
                <Grid ColumnDefinitions="*,10,*" ColumnSpacing="0">
                    <!-- Duration Card -->
                    <Frame Grid.Column="0"
                        BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#2D2D2D}"
                        CornerRadius="10" 
                        Padding="15"
                        HasShadow="True"
                        HorizontalOptions="FillAndExpand">
                        <VerticalStackLayout HorizontalOptions="Center" Spacing="5">
                            <Label Text="â±ï¸" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="{Binding BusinessTrip.Days, StringFormat='{0} Ğ´Ğ½Ğ¸'}" 
                                FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                            <Label Text="ĞŸÑ€Ğ¾Ğ´ÑŠĞ»Ğ¶Ğ¸Ñ‚ĞµĞ»Ğ½Ğ¾ÑÑ‚" FontSize="12" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Cost Card -->
                    <Frame Grid.Column="2"
                        BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#2D2D2D}"
                        CornerRadius="10" 
                        Padding="15"
                        HasShadow="True"
                        HorizontalOptions="FillAndExpand">
                        <VerticalStackLayout HorizontalOptions="Center" Spacing="5">
                            <Label Text="ğŸ’°" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="{Binding TotalExpenses, StringFormat='{0:N0} Ğ»Ğ²'}" 
                                FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                            <Label Text="ĞĞ±Ñ‰Ğ¾ Ñ€Ğ°Ğ·Ñ…Ğ¾Ğ´Ğ¸" FontSize="12" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Frame>
                </Grid>

                <!-- Edit Mode Toggle -->
                <Frame IsVisible="{Binding CanEdit}"
                       BackgroundColor="{AppThemeBinding Light=#FFF3CD, Dark=#856404}"
                       CornerRadius="10"
                       Padding="15"
                       BorderColor="{AppThemeBinding Light=#FFEAA7, Dark=#F39C12}">
                    <Grid ColumnDefinitions="*,Auto">
                        <VerticalStackLayout>
                            <Label Text="Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ°Ğ½Ğµ" FontSize="16" FontAttributes="Bold"/>
                            <Label Text="ĞĞ°Ñ‚Ğ¸ÑĞ½ĞµÑ‚Ğµ Ğ±ÑƒÑ‚Ğ¾Ğ½Ğ° Ğ·Ğ° Ğ´Ğ° Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ°Ñ‚Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°Ñ‚Ğ°" FontSize="12"/>
                        </VerticalStackLayout>
                        <Button Grid.Column="1" 
                                Text="{Binding IsEditing}"
                                Command="{Binding ToggleEditCommand}"
                                BackgroundColor="{AppThemeBinding Light=#007AFF, Dark=#0A84FF}"
                                TextColor="White"
                                CornerRadius="20"
                                Padding="20,10"/>
                    </Grid>
                </Frame>

                <!-- Trip Details -->
                <Frame BorderColor="LightGray" CornerRadius="10" Padding="20" HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ğŸ“‹ Ğ”ĞµÑ‚Ğ°Ğ¹Ğ»Ğ¸ Ğ·Ğ° ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°" FontSize="18" FontAttributes="Bold"/>
                        
                        <!-- Project Name -->
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞŸÑ€Ğ¾ĞµĞºÑ‚:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.ProjectName}" 
                                   IsEnabled="{Binding IsEditing}"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>
                        
                        <!-- Task -->
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.Task}" 
                                   IsEnabled="{Binding IsEditing}"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>
                        
                        <!-- Dates -->
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞĞ°Ñ‡Ğ°Ğ»Ğ½Ğ° Ğ´Ğ°Ñ‚Ğ°:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <DatePicker Grid.Column="1" 
                                       Date="{Binding BusinessTrip.StartDate}" 
                                       IsEnabled="{Binding IsEditing}"
                                       Format="dd/MM/yyyy"
                                       TextColor="{Binding IsEditing}"
                                       FontSize="14"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞšÑ€Ğ°Ğ¹Ğ½Ğ° Ğ´Ğ°Ñ‚Ğ°:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <DatePicker Grid.Column="1" 
                                       Date="{Binding BusinessTrip.EndDate}" 
                                       IsEnabled="{Binding IsEditing}"
                                       Format="dd/MM/yyyy"
                                       TextColor="{Binding IsEditing}"
                                       FontSize="14"/>
                        </Grid>
                        
                        <!-- Destination -->
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ”ĞµÑÑ‚Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.CarTripDestination}" 
                                   IsEnabled="{Binding IsEditing}"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞÑ‚Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ½Ğ¾ÑÑ‚ Ğ·Ğ° Ñ€Ğ°Ğ·Ñ…Ğ¾Ğ´Ğ¸:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                Text="{Binding BusinessTrip.ExpensesResponsibility}" 
                                IsEnabled="{Binding IsEditing}"
                                TextColor="{Binding IsEditing}"
                                FontSize="14"/>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Financial Details -->
                <Frame BorderColor="LightGray" CornerRadius="10" Padding="20" HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ğŸ’° Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ° Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ" FontSize="18" FontAttributes="Bold"/>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ”Ğ½ĞµĞ²Ğ½Ğ¸ Ğ¸Ğ·Ğ´Ñ€ÑŠĞ¶ĞºĞ¸:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.Wage}" 
                                   IsEnabled="{Binding IsEditing}"
                                   Keyboard="Numeric"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞšĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ½Ğ¸ Ğ¸Ğ·Ğ´Ñ€ÑŠĞ¶ĞºĞ¸:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.AccommodationMoney}" 
                                   IsEnabled="{Binding IsEditing}"
                                   Keyboard="Numeric"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞĞ±Ñ‰Ğ¾:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Label Grid.Column="1" 
                                   Text="{Binding TotalExpenses, StringFormat='{0:N2} Ğ»Ğ²'}" 
                                   FontSize="16" FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#007AFF, Dark=#0A84FF}"/>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Vehicle Information -->
                <Frame BorderColor="LightGray" CornerRadius="10" Padding="20" HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ğŸš— Ğ¢Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ½Ğ° Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ" FontSize="18" FontAttributes="Bold"/>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞœĞ°Ñ€ĞºĞ°:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.CarBrand}" 
                                   IsEnabled="{Binding IsEditing}"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="ĞœĞ¾Ğ´ĞµĞ»:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.CarModel}" 
                                   IsEnabled="{Binding IsEditing}"
                                   TextColor="{Binding IsEditing}"
                                   FontSize="14"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ ĞµĞ³. Ğ½Ğ¾Ğ¼ĞµÑ€:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                   Text="{Binding BusinessTrip.CarRegistrationNumber}" 
                                   IsEnabled="{Binding IsEditing}"
                                   TextColor="{Binding IsEditing    }"
                                   FontSize="14"/>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ¡Ğ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ¾ÑÑ‚:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                Text="{Binding BusinessTrip.CarOwnership}" 
                                IsEnabled="{Binding IsEditing}"
                                TextColor="{Binding IsEditing}"
                                FontSize="14"/>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ Ğ°Ğ·Ñ…Ğ¾Ğ´:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                Text="{Binding BusinessTrip.CarUsagePerHundredKm}" 
                                IsEnabled="{Binding IsEditing}"
                                TextColor="{Binding IsEditing}"
                                FontSize="14"/>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                            <Label Text="Ğ¦ĞµĞ½Ğ° Ğ½Ğ° Ğ³Ğ¾Ñ€Ğ¸Ğ²Ğ¾ Ğ·Ğ° Ğ»Ğ¸Ñ‚ÑŠÑ€:" FontSize="14" FontAttributes="Bold" VerticalOptions="Center"/>
                            <Entry Grid.Column="1" 
                                Text="{Binding BusinessTrip.PricePerLiter}" 
                                IsEnabled="{Binding IsEditing}"
                                TextColor="{Binding IsEditing}"
                                FontSize="14"/>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Action Buttons -->
                <VerticalStackLayout Spacing="10" Margin="0,20,0,0">
                    <Button Text="Ğ—Ğ°Ğ¿Ğ°Ğ·Ğ¸ Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ" 
                            Command="{Binding SaveCommand}"
                            IsVisible="{Binding IsEditing}"
                            HorizontalOptions="Fill"
                            BackgroundColor="{AppThemeBinding Light=#28A745, Dark=#2ECC71}"
                            TextColor="White"
                            FontSize="16"
                            HeightRequest="50"/>
                    
                    <Button Text="ĞÑ‚ĞºĞ°Ğ·" 
                            Command="{Binding CancelEditCommand}"
                            IsVisible="{Binding IsEditing}"
                            HorizontalOptions="Fill"
                            BackgroundColor="{AppThemeBinding Light=#DC3545, Dark=#E74C3C}"
                            TextColor="White"
                            FontSize="16"
                            HeightRequest="50"/>
                    
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>